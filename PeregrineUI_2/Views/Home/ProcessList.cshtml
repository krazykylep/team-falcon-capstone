@*
Author   : Chinh T Cao
           Anh T Nguyen
Version  : 1.0.0
Date     : 12/29/2011
Copyright: Capstone Project Team Falcon 2011 All right reserved
*@

@model PeregrineUI_2.Models.PageData<PeregrineUI_2.Models.Process>

<script type="text/javascript">
    
    // Expand process detail
    $(document).ready(function () {
        Main_partial_page_setup (@(Model.CurrentPage), @(Model.SortingType));
        $(".arrow_bg").bind("click", function(event){
            Main_page_sorting($(event.currentTarget).attr("id"));
        });
        $("#main_page_load_more").bind("click", {curPage: main_page_accumulate_page, curSort: main_page_current_sort}, function(event){
            MainPageAjaxUpdate((event.data.curPage+1), event.data.curSort, document.getElementById('main_page_search_input').value);
        });
    });

    
</script>

<!-- Main table -->
<table id="process_table" class="display">

    <!-- Table header: Display column names, use checkboxes for Sorting -->
    <thead id = "process_list_header">     
        <tr>
            <td>
                <div style="float: left">Process Name</div> 
                <div style="float: right">           
                   
                               
                    <div id="Main_page_pro_name_sort_acc" class="arrow_bg"><div class="up_arrow @if(Model.SortingType == 0){
                                                                                                                                          @:arrow_selected
                                                                                                                                          }"></div></div>
                    <div id="Main_page_pro_name_sort_desc" class="arrow_bg"><div class="down_arrow @if(Model.SortingType == 1){
                                                                                                                                             @:arrow_selected
                                                                                                                                          }"></div></div>
                </div>                               
            </td>
            <td>
                <div style="float: left">Last Message</div> 
                <div style="float: right">           
                    

                    <div id="Main_page_last_msg_sort_acc" class="arrow_bg"><div class="up_arrow @if(Model.SortingType == 2){
                                                                                                                                             @:arrow_selected
                                                                                                                                          }"></div></div>
                    <div id="Main_page_last_msg_sort_desc" class="arrow_bg"><div class="down_arrow @if(Model.SortingType == 3){
                                                                                                                                             @:arrow_selected
                                                                                                                                          }"></div></div>
                </div>            
            </td>
            <td>
                <div style="float: left">Message Date</div> 
                <div style="float: right">           
                    

                    <div id="Main_page_msg_date_sort_acc" class="arrow_bg"><div class="up_arrow @if(Model.SortingType == 4){
                                                                                                                                             @:arrow_selected
                                                                                                                                          }"></div></div>
                    <div id="Main_page_msg_date_sort_desc" class="arrow_bg"><div class="down_arrow @if(Model.SortingType == 5){
                                                                                                                                             @:arrow_selected
                                                                                                                                          }"></div></div>
                </div>              
            </td>
            <td>
                <div style="float: left">Process State</div> 
                <div style="float: right">           
                    

                    <div id="Main_page_pro_state_sort_acc" class="arrow_bg"><div class="up_arrow @if(Model.SortingType == 6){
                                                                                                                                             @:arrow_selected
                                                                                                                                          }"></div></div>
                    <div id="Main_page_pro_state_sort_desc" class="arrow_bg"><div class="down_arrow @if(Model.SortingType == 7){
                                                                                                                                             @:arrow_selected
                                                                                                                                          }"></div></div>
                </div>                 
            </td>
            <td>
                Current Job's Progress
            </td>
        </tr>
    </thead>


    <!-- Table Body: Display summary & details -->
    <tbody>
        <!-- For every process -->
        @foreach (var process in Model.Data)
        {
            <!-- Show summary -->
            <tr id="Process_@(process.ProcessId)">
                <td>@process.ProcessName </td>
                <td>@process.LastAction </td>
                <td>@process.MsgDate.ToString("yyyy-MM-dd HH:mm tt") </td>
                <td style="text-align: center;"><img src="../../Content/images/@(process.ProcessState.Trim()).png" alt=""/> </td>
                <td>@if (process.MessageType > 1)
                    {
                        <div class="meter-wrap" width: 100px;>
                            <div class="meter-value" style="background-color: #3399CC; width: @(process.JobPercentage)%;">
                                <div class="meter-text">
                                    @(process.JobPercentage)%
                                </div>
                            </div>
                        </div>
                    }</td>
            </tr>
        }
    </tbody>
    <tfoot>
        <tr>
            <td colspan="5">
                <div style="text-align: center;"><input id="main_page_load_more" type="button" class="ui_button" value="Load More" /></div>
            </td>
        </tr>              
    </tfoot>
</table>
<script type="text/javascript">
    for (var x = 0; x < $("#process_table tr").length-1; ++x) {
        $("#process_table tr").eq(x).bind("click", { num: x }, function (event) {
            if (event.data.num > 0) {
                toggleMoreInfo($("#process_table tr").eq(event.data.num).attr("id"));
            }
        });
    }
</script>