@*
Author   : Chinh T Cao
           Anh T Nguyen
Version  : 1.0.0
Date     : 12/29/2011
Copyright: Capstone Project Team Falcon 2011 All right reserved
*@

@model PeregrineUI_2.Models.PageData<PeregrineUI_2.Models.Process>

<script type="text/javascript">
    
    // Expand process detail
    $(document).ready(function () {
        Main_partial_page_setup (@(Model.CurrentPage), @(Model.SortingType));
    });

    
</script>

<!-- Main table -->
<table id="process_table" class="display">

    <!-- Table header: Display column names, use checkboxes for Sorting -->
    <thead id = "process_list_header">     
        <tr>
            <td>
                <div style="float: left">Process Name</div> 
                <div style="float: right">           
                   
                               
                    <div id="Main_page_pro_name_sort_acc" onclick="Main_page_sorting(this.id);" class="arrow_bg"><div class="up_arrow @if(Model.SortingType == 0){
                                                                                                                                          @:arrow_selected
                                                                                                                                          }"></div></div>
                    <div id="Main_page_pro_name_sort_desc" onclick="Main_page_sorting(this.id);" class="arrow_bg"><div class="down_arrow @if(Model.SortingType == 1){
                                                                                                                                             @:arrow_selected
                                                                                                                                          }"></div></div>
                </div>                               
            </td>
            <td>
                <div style="float: left">Last Message</div> 
                <div style="float: right">           
                    

                    <div id="Main_page_last_msg_sort_acc" onclick="Main_page_sorting(this.id);" class="arrow_bg"><div class="up_arrow @if(Model.SortingType == 2){
                                                                                                                                             @:arrow_selected
                                                                                                                                          }"></div></div>
                    <div id="Main_page_last_msg_sort_desc" onclick="Main_page_sorting(this.id);" class="arrow_bg"><div class="down_arrow @if(Model.SortingType == 3){
                                                                                                                                             @:arrow_selected
                                                                                                                                          }"></div></div>
                </div>            
            </td>
            <td>
                <div style="float: left">Message Date</div> 
                <div style="float: right">           
                    

                    <div id="Main_page_msg_date_sort_acc" onclick="Main_page_sorting(this.id);" class="arrow_bg"><div class="up_arrow @if(Model.SortingType == 4){
                                                                                                                                             @:arrow_selected
                                                                                                                                          }"></div></div>
                    <div id="Main_page_msg_date_sort_desc" onclick="Main_page_sorting(this.id);" class="arrow_bg"><div class="down_arrow @if(Model.SortingType == 5){
                                                                                                                                             @:arrow_selected
                                                                                                                                          }"></div></div>
                </div>              
            </td>
            <td>
                <div style="float: left">Process State</div> 
                <div style="float: right">           
                    

                    <div id="Main_page_pro_state_sort_acc" onclick="Main_page_sorting(this.id);" class="arrow_bg"><div class="up_arrow @if(Model.SortingType == 6){
                                                                                                                                             @:arrow_selected
                                                                                                                                          }"></div></div>
                    <div id="Main_page_pro_state_sort_desc" onclick="Main_page_sorting(this.id);" class="arrow_bg"><div class="down_arrow @if(Model.SortingType == 7){
                                                                                                                                             @:arrow_selected
                                                                                                                                          }"></div></div>
                </div>                 
            </td>
            <td>
            </td>
        </tr>
    </thead>


    <!-- Table Body: Display summary & details -->
    <tbody>
        <!-- For every process -->
        @foreach (var process in Model.Data)
        {
            <!-- Show summary -->
            <tr id="Process_@(process.ProcessId)" onclick="toggleMoreInfo('Process_@(process.ProcessId)')">
                <td>@process.ProcessName </td>
                <td>@process.LastAction </td>
                <td>@process.MsgDate.ToString("yyyy-MM-dd HH:mm tt") </td>
                <td style="text-align: center;"><img src="../../Content/images/@(process.ProcessState.Trim()).png" alt=""/> </td>
                <td><div class="arrow"></div></td>
                           
            </tr>
            
            <!-- If click on the process, expand the table, show process details -->
            <tr id="Process_@(process.ProcessId)_more" class="more_info_rows" style="display: none;">
                <td colspan="5">
                    <!-- Table of messages in current process -->
                    <input id="Process_@(process.ProcessId)JobBtn" type="button" value="Show Jobs"
                            onclick="show_job('1', 'Process_@(process.ProcessId)', @(process.ProcessId))"/>
                    <!-- Partial View: Message --> 
                    <div  id = "Process_@(process.ProcessId)message" style="display:inline-block; width:100%">
                        <div class = "Process_@(process.ProcessId)message"></div>
                    </div>

                    <!-- Table of jobs in current process -->
                    <input id="Process_@(process.ProcessId)MsgBtn" type="button" value="Show Messages" style="display:none" 
                            onclick="show_message('1', 'Process_@(process.ProcessId)', @(process.ProcessId))"/>
                    <!-- Partial View: Job -->
                    <div id = "Process_@(process.ProcessId)job" style="display:none; width:100%">
                        <div class = "Process_@(process.ProcessId)job"></div>
                    </div>
                </td>
            </tr>
        }
    </tbody>

    <!-- Table footer: Paging -->
    <tfoot>
        <tr>
            <td colspan="5">
                <div style="text-align: center;"><input type="button" class="ui_button" value="Load More" onclick="MainPageAjaxUpdate((main_page_accumulate_page+1), main_page_current_sort, document.getElementById('main_page_search_input').value)" /></div>
            </td>
        </tr>              
    </tfoot>
</table>