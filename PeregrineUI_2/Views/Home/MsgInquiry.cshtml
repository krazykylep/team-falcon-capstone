@*
Author   : Chinh T Cao        
Version  : 1.0.0
Date     : 1/11/2012
Copyright: Capstone Project Team Falcon 2011 All right reserved
*@
                     
@{
    ViewBag.Title = "Messages Summary";
}

<h2>Message Inquiry</h2>
<h3>Note: Show all messages from all processes</h3> 

<script type="text/javascript">

    var msg_inquiry_current_page;
    var msg_inquiry_current_sort;

    /**/
    function Msg_inquiry_collect_info(page_number, sort_option, process_priority, process_name) {
        // Getting the current state of the SU_SD_Checkbox checkbox
        var state = document.getElementById("SU_SD_Checkbox").checked;

        // Run MsgInquiryUpdate with the additional value of SU_SD_Checkbox
        if (state) {
            MsgInquiryUpdate(page_number, sort_option, process_priority, process_name, '1');
        }
        else {
            MsgInquiryUpdate(page_number, sort_option, process_priority, process_name, '0');
        }
    }

    /**/
    function showpopup(msg_id) {
        if (document.getElementById("popwindow").className == 'popperHid') {
            // Update the div
            GetFullDetailMessage(msg_id);
            document.getElementById("popwindow").className = 'popperShow';
        } else {
            document.getElementById("popwindow").className = 'popperHid';
        }
        return false;
    }

    /**/
    function Change_SU_SD_Status(sort_option, process_priority, process_name) 
    {
        // Getting the current state of the SU_SD_Checkbox checkbox
        var state = document.getElementById("SU_SD_Checkbox").checked;

        // Run MsgInquiryUpdate with the additional value of SU_SD_Checkbox
        if (state) {
            MsgInquiryUpdate('1', sort_option, process_priority, process_name, '1');
        }
        else {
            MsgInquiryUpdate('1', sort_option, process_priority, process_name, '0');
        }
    }

    /**/
    $(document).ready(function () {
        // Fix event.layerx and layery broken warning, work like a charm
        var all = $.event.props,
        len = all.length,
        res = [];
        while (len--) {
            var el = all[len];
            if (el != 'layerX' && el != 'layerY') res.push(el);
        }
        $.event.props = res;

        // Set up the initial stage of the message inquiry page
        MsgInquiryUpdate(
                            "1",
                            "5",
                            "0",
                            "",
                            "0"
                        );

        // Handle clicking page number 
        $(".msg_inquiry_page-number").live("click", function () {
            Msg_inquiry_collect_info(
                                        $(this).html(),
                                        msg_inquiry_current_sort,
                                        document.getElementById("process_prio_input").value,
                                        document.getElementById("process_name_input").value
                                    );
        });

        // Automatic update
        setInterval(function () {
            Msg_inquiry_collect_info(
                                        msg_inquiry_current_page,
                                        msg_inquiry_current_sort,
                                        document.getElementById("process_prio_input").value,
                                        document.getElementById("process_name_input").value
                                    );
        }, 5000);

        // Use enter to send value in input box. Work for IE, Firefox and Chrome
        $('#process_name_input').keypress(function (e) {
            var code = (e.keyCode ? e.keyCode : e.which);
            if (code == 13) {           
                Msg_inquiry_collect_info(
                                            '1',
                                            '1',
                                            document.getElementById("process_prio_input").value,
                                            document.getElementById("process_name_input").value
                                         );
            }
        });
    });

</script>

<nav>
    <ul id="menu">
        <li>@Html.ActionLink("Home Page", "Index", "Home")</li>
    </ul>
</nav>

<label>Search message by process name:</label>
<input  id="process_name_input" type="text"/>

<br />

<label>Search message by message priority:</label>
<select id="process_prio_input" 
        onchange="Msg_inquiry_collect_info ( 
                                                '1',
                                                '1',                                      
                                                document.getElementById('process_prio_input').value,
                                                document.getElementById('process_name_input').value
                                            )">
    <option value="0">0</option>                                            
    <option value="1">1</option>
    <option value="2">2</option>
    <option value="3">3</option>
    <option value="4">4</option>
    <option value="5">5</option>
    <option value="6">6</option>
    <option value="7">7</option>
    <option value="8">8</option>
    <option value="9">9</option>
    <option value="10">10</option>
</select>

<br />

<label>Get all start up and shutdown msg: </label>
<input id="SU_SD_Checkbox" type="checkbox" 
        onclick="Change_SU_SD_Status (
                                        '1',
                                        document.getElementById('process_prio_input').value,
                                        document.getElementById('process_name_input').value  
                                        )"/>
   
                                                                            
<hr />

<div class="message-list"></div>

<div id="popwindow" class="popperHid">
    <div id="popwindow_message"> </div>
    <div id="closebutton"><input type="button" value="Close this message" onClick="showpopup();"></div>
</div>

<!-- Code development corner -->
