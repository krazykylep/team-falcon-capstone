@*
Author   : Chinh T Cao
Version  : 1.0.0
Date     : 12/29/2011
Copyright: Capstone Project Team Falcon 2011 All right reserved
*@

@model PeregrineUI_2.Models.PagedData<PeregrineUI_2.Models.Process>

<table>
    <thead>
        <tr>
            <td>ProcessName</td>
            <td>LastAction</td>
            <td>MsgDate</td>
            <td>ProcessState</td>
        </tr>
    </thead>
    <tbody>
        @foreach (var process in Model.Data)
        {
            <tr>
                <td>@process.ProcessName</td>
                <td>@process.LastAction</td>
                <td>@process.MsgDate</td>
                <td>@process.ProcessState</td>
            </tr>
        }
    </tbody>
    <tfoot>
        <tr>
            <td colspan="4">
                @{     
                        
                        int start, end;
                        
                        // Get the value of start and end based on the value of currpage and total number of page
                        if (Model.NumberOfPages <= 5)
                        {
                            // If the total number of page is less than 5, show all to user
                            start = 0;
                            end = Model.NumberOfPages;    
                        }
                        else
                        {
                            // Else, allows user to choose first page, last page and 5 other page around current chose page
                            start = Model.CurrentPage - 2;
                            end = Model.CurrentPage + 2;
                            
                            if (start < 1)
                            {
                                start = 1;
                                end = 5;
                            } 
                            else if (end > Model.NumberOfPages)
                            {
                                start = Model.NumberOfPages - 4;
                                end = Model.NumberOfPages;
                            }
                        }
                                                                                                                                
                        for (int i = 1; i <= Model.NumberOfPages; i++)
                        {
                            if (i < start)
                            {
                               if ( i == 1) 
                               {
                                    <a class="page-number" href="javascript:void();">@i</a>   
                               } 
                               else
                               {
                                    <label>...</label>
                                    i = start - 1;
                               }            
                            }
                            else if (i > end)
                            {
                                if ( i == Model.NumberOfPages)
                                {
                                    <a class="page-number" href="javascript:void();">@i</a>
                                }
                                else
                                {
                                    <label>...</label>
                                    i = Model.NumberOfPages - 1;
                                }
                            }
                            else if (i == Model.CurrentPage)
                            {
                                @i
                            }
                            else
                            {
                                <a class="page-number" href="javascript:void();">@i</a>
                            }
                        }    
                                                               
                }
                            
                <label>|</label>
                <label>Go to page:</label>
                <input id="page_target" type="text" style="width: 40px" onchange="paging(document.getElementById(this.id).value)"/>
                
            </td>
        </tr>              
    </tfoot>
</table>